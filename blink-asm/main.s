.set RESETS_BASE, 0x40020000
.set RESETS_RESET_OFFSET, 0x0
.set REG_ALIAS_CLR_BITS, 0x3000
.set RESETS_RESET_IO_BANK0_BITS, 1<<6
.set RESETS_RESET_PADS_BANK0_BITS, 1<<9
.set RESETS_RESET_DONE_OFFSET, 0x8
.set RESETS_RESET_DONE_IO_BANK0_BITS, 1<<6
.set RESETS_RESET_DONE_PADS_BANK0_BITS, 1<<9
.set IO_BANK0_BASE, 0x40028000
.set IO_BANK0_GPIO25_CTRL_OFFSET, 0x4 + 25*0x8
.set GPIO_FUNC_SIO, 5
.set PADS_BANK0_BASE, 0x40038000
.set PADS_BANK0_GPIO25_OFFSET, 0x4 + 25*0x4
.set REG_ALIAS_CLR_BITS, 0x3000
.set PADS_BANK0_GPIO0_ISO_BITS, 1<<8
.set SIO_BASE, 0xd0000000
.set SIO_GPIO_OE_SET_OFFSET, 0x38
.set SIO_GPIO_OUT_XOR_OFFSET, 0x28
.set PIN, 25

.word _estack
.word prog + 1

.word 0xffffded3
.word 0x10210142
.word 0x000001ff
.word 0x00000000
.word 0xab123579

prog:
ldr r0, = RESETS_BASE + RESETS_RESET_OFFSET + REG_ALIAS_CLR_BITS
ldr r1, = RESETS_RESET_IO_BANK0_BITS | RESETS_RESET_PADS_BANK0_BITS
str r1, [r0]

ldr r2, = RESETS_RESET_DONE_IO_BANK0_BITS | RESETS_RESET_DONE_PADS_BANK0_BITS
ldr r0, = RESETS_BASE + RESETS_RESET_DONE_OFFSET
0:
ldr r1, [r0]
mvn r1, r1
and r1, r1, r2
bne 0b

ldr r0, = IO_BANK0_BASE + IO_BANK0_GPIO25_CTRL_OFFSET
mov r1, # GPIO_FUNC_SIO
str r1, [r0]

ldr r0, = PADS_BANK0_BASE + PADS_BANK0_GPIO25_OFFSET + REG_ALIAS_CLR_BITS
ldr r1, = PADS_BANK0_GPIO0_ISO_BITS
str r1, [r0]

ldr r0, = SIO_BASE + SIO_GPIO_OE_SET_OFFSET
ldr r1, = (1<<PIN)
str r1, [r0]

ldr r0, = SIO_BASE + SIO_GPIO_OUT_XOR_OFFSET
0:
str r1, [r0]

ldr r2, = 1000000
1:
sub r2, # 1
bne 1b

b 0b
